<!DOCTYPE html>
<html>
	<head>
		<title>New York Times Daily Crossword</title>
		<meta name="GENERATOR" content="Microsoft Visual Studio .NET 7.1">
		<meta name="vs_targetSchema" content="http://schemas.microsoft.com/intellisense/ie5">
		<meta http-equiv="X-UA-Compatible" content="IE=edge">
		<meta name="viewport" content="width=1024,  height=468, initial-scale=1, xminimum-scale=.5, xmaximum-scale=2, user-scalable=yes">

		<style type="text/css">
			*{user-select:none;cursor: default;}
			.vblack {background-color:#000000;visibility:visible;}
			.num{height:6pt;font-family:arial;font-size:6pt;visibility:visible}
			.letter{height:100%;width:100%;font-family:helvetica;font-size:8pt;text-align:center;display:none;}
			.subst{font-family:verdana;font-size:8pt;text-align:center;display:normal;}
			.subst2{font-family:verdana;font-size:8pt;text-align:center;display:normal;}
			.copy{font-family:Arial;font-weight:bold;font-size:7pt;}

			.PuzTable {margin-bottom:0px;border-collapse:collapse;}
			.PuzTable td {vertical-align:top;height:24px;width:24px;border:1px solid black;padding:0px;}
			.PuzTitle{font-family:Arial;font-weight:normal;font-size:8pt;}
			.puzzle-selection
			{
				z-index:1000;
				width:250px;
				font-family:Arial;
				font-size:9pt;
				background-color:white;
				border:1px solid black;
				padding:5px;
				margin-bottom:10px;
				box-shadow: 5px 5px 5px gray;
			}
			.puzzle-selection *{vertical-align: middle;}
			.puzzle-selection .date-picker{width: 105px;}
			.puzzle-selection .ctrl-container{margin-top:5px;}
			.puzzle-clues a{visibility:hidden;}
			.puzzle-clues-across, .puzzle-clues-down, td
			{
				font-family:Arial;
				font-size:7pt;
				vertical-align:top;
			}
			.puzzle-across-header
			{
				font-size:9pt;
				font-weight:bold;
				padding:10px 0px 5px 0px;
			}

			@media print
			{
				.puzzle-selection{display: none;}
			}
		</style>

		<link rel="stylesheet" href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.11.4/themes/smoothness/jquery-ui.css">
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.4/jquery.js"></script>
		<script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.11.4/jquery-ui.js"></script>

		<link rel="stylesheet" href="./widget_box.css">
		<script src="./widget_box.js"></script>

		<script type="text/javascript">
			sprintf = function (sPattern, args) {
				var _args = arguments;
				return sPattern && sPattern.replace(/\%(\d+)/g, function (s, n) {
					return _args[n];
				});
			};
			$(function()
			{
				function LoadPuzzle(date)
				{
					var strParm = sprintf("http://www.xwordinfo.com/Crossword?date=%1", $.datepicker.formatDate("mm/dd/yy", date));
					var strUri = "./proxy.jsp?" + strParm;
					var ret = $.ajax(
					{
						"url": strUri,
						"dataType":"html",
						"success":function(puzzlePage)
						{
							puzzlePage = puzzlePage.replace(/ : <a/g, "<a");
							var $puzzPage = $(puzzlePage);
							var $puzzTab = $puzzPage.find("#CPHContent_PuzTable");
							var $puzzTitle = $puzzPage.find("#CPHContent_TitleLabel").addClass("PuzTitle");
							var $puzzCRight = $puzzPage.find("#CPHContent_Copyright");

							var $puzzSelection = $(".puzzle-selection");

							var $puzzContainer = $(".puzzle-container").empty();
							$puzzContainer.append($puzzTitle);
							$puzzContainer.append($puzzTab);
							$puzzContainer.append($puzzCRight);
							
							var $puzzClues = $(".puzzle-clues");
							var $cluesAcross = $(".puzzle-clues-across").append($puzzPage.find("#CPHContent_AcrossClues"));
							var $cluesDown = $(".puzzle-clues-down").append($puzzPage.find("#CPHContent_DownClues"));
						
							var $puzzlePageContainer = $(".puzzle-page-container");
						},
						"error":function(xhr, strError, strMessage)
						{
							$(document.documentElement).html(xhr.responseText);
						}
					});
				}

				var date = new Date();
				$(".date-picker").datepicker().datepicker("setDate", date).on("change", function(e)
				{
					var date = $(e.target).datepicker("getDate");
					LoadPuzzle(date);
				});
				LoadPuzzle(date);

				$("#cbDiagramless").on("change", function(e)
				{
					$(".vblack").css("backgroundColor", (this.checked) ? "white" : "black");
					var idx = $(".num").css("color", (this.checked) ? "white" : "black").index();
				});
				
				$("#cbAnswers").on("change", function(e)
				{
					$(".letter").css("display", (this.checked) ? "inherit" : "none");
				});

				$("#btnPrint").on("click", function(e)
				{
					window.print();
				});

				var dlgSel = $("#dlgPuzzSel");
				dlgSel.flexbox({"direction":"column"}).css({"display":"hidden", "width":"250px", "border":"2px solid black", "padding":"10px"});

				var boxDateOptions = $("#puzzDateOptions").css("marginBottom", 10);;
				boxDateOptions.flexbox({}).flexitem({"grow":1}).css("border", "1px solid red");

				var puzzDate = $("#puzzDate");
				puzzDate.css({"maxWidth":"50px"});
			});
		</script>
	</head>
	<body>
		
		<div id="dlgPuzzSel" data-role-flexbox="box">
			<div id="puzzDateOptions" data-role-flexbox="box, item">
				<label for="puzzDate" data-role-flexbox="item">Puzzle Date:</label>
				<input id="puzzDate" data-role-flexbox="item" type="text" readonly="">
				<button id="btnPuzzPrint" data-role-flexbox="item">Print...</button>
			</div>
			<div id="puzzOptions" data-role-flexbox="box, item">
				<input id="showAnswers" type="checkbox" data-role-flexbox="item"/>
				<label for="showAnswers" data-role-flexbox="item">Anwsers</label>
				<input id="makeDiagramless" type="checkbox" data-role-flexbox="item"/>
				<label for="makeDiagramless" data-role-flexbox="item">Diagramless</label>
			</div>
		</div>

		<script type="text/javascript">
			var flexBox = $("#boxTest").flexbox({"direction":"row", "justify":"center", "alignItems":"center"})
		</script>

		<div class="puzzle-page-container">

			<div class="puzzle-selection">
				<div>
					Puzzle Date: <input type="text" class="date-picker" readonly="">
					<button id="btnPrint">Print...</button>
				</div>
				<div class="ctrl-container">
					<input id="cbAnswers" type="checkbox"/>
					<label for="cbAnswers">Anwsers</label>
					<input id="cbDiagramless" type="checkbox"/>
					<label for="cbDiagramless">Diagramless</label>
				</div>
			</div>

			<div class="puzzle-container">
			</div>

			<table class="puzzle-clues">
				<tr>
					<td>
						<div class="puzzle-clues-across">
							<div class="puzzle-across-header">Across</div>
						</div>
					</td>
					<td>
						<div class="puzzle-clues-down">
							<div class="puzzle-across-header">Down</div>
						</div>
					</td>
				</tr>
			</table>

		</div>
	</body>
</html>

